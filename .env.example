# AegisMind SIEM Configuration Template
# Copy this file to .env and fill in your own values
# NEVER commit the actual .env file to version control!

# =============================================================================
# MONGODB CONFIGURATION
# =============================================================================
# MongoDB connection string with replica set
# For local development: mongodb://localhost:27017/?replicaSet=rs0
# For production: Use your MongoDB Atlas or hosted instance URL
MONGO_URI=mongodb://localhost:27017/?replicaSet=rs0

# Database name for SIEM data
MONGO_DB_NAME=cog_siem

# MongoDB retention policy (days to keep events)
MONGO_RETENTION_DAYS=14

# =============================================================================
# SECURITY CONFIGURATION
# =============================================================================
# HMAC secret for API authentication - MUST BE CHANGED!
# Generate a strong secret: openssl rand -base64 32
# This is used to verify incoming event ingestion requests
HMAC_SECRET=CHANGE_ME_TO_A_STRONG_RANDOM_SECRET

# Maximum request body size (bytes)
MAX_BODY_SIZE=1048576

# =============================================================================
# SERVER CONFIGURATION
# =============================================================================
# WebSocket server port for real-time updates
WS_PORT=8081

# REST API server port
REST_PORT=8080

# Server bind address (0.0.0.0 for all interfaces, 127.0.0.1 for localhost only)
BIND_ADDRESS=0.0.0.0

# =============================================================================
# CLUSTERING & CORRELATION
# =============================================================================
# Time window for event clustering (seconds)
CLUSTERING_WINDOW_SECONDS=120

# Minimum events required to form a cluster
CLUSTERING_MIN_EVENTS=5

# Similarity threshold for clustering (0.0 to 1.0)
CLUSTERING_SIMILARITY_THRESHOLD=0.75

# Correlation window (seconds)
CORRELATION_WINDOW_SECONDS=120

# =============================================================================
# RATE LIMITING
# =============================================================================
# Maximum events per minute
MAX_EVENTS_PER_MINUTE=10000

# Event buffer size
BUFFER_SIZE=50000

# =============================================================================
# LOGGING CONFIGURATION
# =============================================================================
# Log level: debug, info, warn, error
LOG_LEVEL=info

# Log file path
LOG_FILE=logs/siem.log

# =============================================================================
# PRODUCTION SECURITY CHECKLIST
# =============================================================================
# Before deploying to production:
# [ ] Change HMAC_SECRET to a strong random value
# [ ] Use a secure MongoDB connection (TLS/SSL)
# [ ] Set BIND_ADDRESS appropriately for your network
# [ ] Enable MongoDB authentication
# [ ] Configure firewall rules
# [ ] Set up log rotation
# [ ] Enable HTTPS for REST API
# [ ] Review and adjust rate limits
# [ ] Set appropriate retention policies
